language: java

jdk: openjdk10

before_install:
  - chmod +x gradlew
  
script:
  - ./gradlew check jacocoTestCoverageVerification

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

after_success:
  - ./gradlew jacocoTestReport coveralls

deploy:
  - provider: releases
    skip_cleanup: true
    api_key:
      secure: jEaUhAPx1cPC39VkZ31MHoOeY7eslWmVn3xys3JIWTf7/d2J6dKhZ3H+ZN4ZzoPzglTDwPrCLm4E4VAgN4Kkiwvd3NPM0yjRS5oSpvZGOzRxhUtx0qJAYjFgYYfYOmeacc9MdiyHmVfP6x9bfOLxjwzZvcapUww6mh1+fzwfL1YHo61ady5JfiORPIh3BRXmgmav+a5ixzhtfHSaIvboQ9P+Xhnc9OVuKAi627HzYb+Im53+v2INobLyYjoETGe/cCqWr/dde9T8eANwwS6Nl3BmSekdXj2o4EOEV4j5okskRzHuRS1t7KRxP8H/bjiigMh0t31gJdutKsYtRH1TX055a4j6Agx/t/SQ9m8GrbSVSql2HnimVMvtWQRUJ8xcO+fMacTYzTBPvZlYFUi5lZ6ZeP5+76bIiiOJp6N40V3EMZl/d6zlchuNP5SPQ9d1GS6S2RjrE0m6XHnfHGyZX+KEGe9V1UV++ZsmRIRRrWH02a/mSqrSf8uFSX0S8cP8E8JceGkRBQvSCJolyAJxOpKy8SW2qY/YyaxDL/e4qOGyW3YVULHx0xNV7XWYMBoaMxI8+bCY2xv6Pov7y/JV/nBHWrEZD8kiX2Ev18n3ON7ADRPsQF+T1mGeRQ2Ae9Nh/LUl2QCGZRCamfAXgDaYAYoAgtcw+SRAYL8Dc0dwWkU=
    file_glob: true
    file: "build/libs/*.jar"
    on:
      tags: true

  - provider: script
    skip_cleanup: true
    script: ./gradlew bintrayUpload
    on:
      tags: true
